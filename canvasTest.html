<html>
<script>
(function(){
	function drawCircle(ctx, x, y, r){
		ctx.beginPath();
		ctx.arc(x, y, r, 0, Math.PI * 2);
	}
	function drawEllipse(ctx, x, y, xr, yr){
	  var kappa = .5522848;
	      ox = xr * kappa, // control point offset horizontal
	      oy = yr * kappa, // control point offset vertical
	      xe = x + xr;       // x-end
	      ye = y + yr,       // y-end
	      xs = x - xr,       // x-start
	      ys = y - yr;       // y-start

	  ctx.beginPath();
	  ctx.moveTo(xs, y);
	  ctx.bezierCurveTo(xs, y - oy, x - ox, ys, x, ys);
	  ctx.bezierCurveTo(x + ox, ys, xe, y - oy, xe, y);
	  ctx.bezierCurveTo(xe, y + oy, x + ox, ye, x, ye);
	  ctx.bezierCurveTo(x - ox, ye, xs, y + oy, xs, y);
	  ctx.closePath();
	}
	CanvasRenderingContext2D.prototype.strokeCircle = function(x, y, radius){
		drawCircle(this, x, y, radius);
		this.stroke();
	};
	CanvasRenderingContext2D.prototype.fillCircle = function(x, y, radius){
		drawCircle(this, x, y, radius);
		this.fill();
	};
	CanvasRenderingContext2D.prototype.strokeEllipse = function(x, y, xr, yr) {
		drawEllipse(this, x, y, xr, yr);
	  	this.stroke();
	}
	CanvasRenderingContext2D.prototype.fillEllipse = function(x, y, xr, yr) {
		drawEllipse(this, x, y, xr, yr);
	  	this.fill();
	}
})();
window.onload = function(){
	var ctx = document.getElementsByTagName('canvas')[0].getContext('2d'),
		canvasHeight = ctx.canvas.height,
		ballRadius = 20,
		a1 = canvasHeight - ballRadius,
		a2 = canvasHeight - ballRadius*2,
		speed = 1/500,
		decay = 500,
		debugLines = true,
		loop = function(t){
			var y = a1-(Math.abs(Math.sin(t*speed)*a2)*(decay/(t+1)));
			ctx.fillStyle = "#fff";
			ctx.fillRect(0,0,200,400);
			if(debugLines){
				ctx.strokeStyle = "rgba(128,128,128,0.7)";
				ctx.beginPath();
				ctx.moveTo(0,a1);
				ctx.lineTo(200,a1);
				ctx.stroke();
				ctx.beginPath();
				ctx.moveTo(0,ballRadius);
				ctx.lineTo(200,ballRadius);
				ctx.stroke();
				ctx.strokeText("x: 100", 5, 10);
				ctx.strokeText("y: " + y.toFixed(1), 5, 20);
			}
			ctx.fillStyle = "#f00";
			if(y<a1)
				ctx.fillCircle(100,y,20);
			else
				ctx.fillEllipse(100,y,ballRadius-(a1-y),ballRadius+(a1-y));
			ctx.fillStyle = "rgba(255,255,255,0.5)";
			ctx.fillEllipse(105,y-5,12,7);
			ctx.strokeEllipse(100,y,30,30);
			if(debugLines){
				ctx.strokeStyle = "rgba(0,128,255,0.7)";
				ctx.beginPath();
				ctx.moveTo(0,y);
				ctx.lineTo(200,y);
				ctx.stroke();
				ctx.beginPath();
				ctx.moveTo(100,0);
				ctx.lineTo(100,400);
				ctx.stroke();
			} 
			requestAnimationFrame(loop);
		};
		requestAnimationFrame(loop);
}
</script>
<canvas height="400" width="200"></canvas>
</html>